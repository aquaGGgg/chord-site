{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{AuthContext}from'../context/AuthContext';import{useNavigate}from'react-router-dom';import songsService from'../services/songsService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProfilePage=()=>{var _user$role;const{user,logout}=useContext(AuthContext);const[likedSongs,setLikedSongs]=useState([]);const navigate=useNavigate();useEffect(()=>{const fetchLikedSongs=async()=>{if(user){try{const favorites=await songsService.getFavorites(user.email);setLikedSongs(favorites);}catch(error){console.error(\"Ошибка при загрузке лайкнутых песен\",error);}}};fetchLikedSongs();},[user]);const removeLike=async songId=>{try{await songsService.removeFavorite(user.id,songId);setLikedSongs(likedSongs.filter(song=>song.id!==songId));}catch(error){console.error(\"Ошибка при удалении лайка\",error);}};const handleAdminPanelClick=()=>{navigate('/admin');};return/*#__PURE__*/_jsxs(\"div\",{style:profileStyle,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0418\\u043C\\u044F: \",user.username||user.email]}),((_user$role=user.role)===null||_user$role===void 0?void 0:_user$role.toLowerCase())==='admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleAdminPanelClick,style:adminButtonStyle,children:\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0430\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041B\\u0430\\u0439\\u043A\\u043D\\u0443\\u0442\\u044B\\u0435 \\u043F\\u0435\\u0441\\u043D\\u0438\"}),likedSongs.length?/*#__PURE__*/_jsx(\"ul\",{style:listStyle,children:likedSongs.map(song=>/*#__PURE__*/_jsxs(\"li\",{style:itemStyle,children:[song.title,/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeLike(song.id),style:removeButtonStyle,children:\"\\u0423\\u0431\\u0440\\u0430\\u0442\\u044C \\u043B\\u0430\\u0439\\u043A\"})]},song.id))}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435\\u0442 \\u043B\\u0430\\u0439\\u043A\\u043D\\u0443\\u0442\\u044B\\u0445 \\u043F\\u0435\\u0441\\u0435\\u043D.\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u043D\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,style:logoutButtonStyle,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]});};const profileStyle={maxWidth:'600px',margin:'50px auto',padding:'20px',backgroundColor:'#333',color:'#fff',borderRadius:'8px'};const listStyle={listStyleType:'none',padding:0};const itemStyle={marginBottom:'10px'};const removeButtonStyle={marginLeft:'10px',backgroundColor:'#555',color:'#fff',border:'none',borderRadius:'4px',cursor:'pointer'};const adminButtonStyle={marginBottom:'20px',padding:'10px',borderRadius:'4px',backgroundColor:'#28a745',color:'#fff',border:'none',cursor:'pointer'};const logoutButtonStyle={marginTop:'20px',padding:'10px',borderRadius:'4px',backgroundColor:'#d9534f',color:'#fff',border:'none',cursor:'pointer'};export default ProfilePage;","map":{"version":3,"names":["React","useContext","useEffect","useState","AuthContext","useNavigate","songsService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProfilePage","_user$role","user","logout","likedSongs","setLikedSongs","navigate","fetchLikedSongs","favorites","getFavorites","email","error","console","removeLike","songId","removeFavorite","id","filter","song","handleAdminPanelClick","style","profileStyle","children","username","role","toLowerCase","onClick","adminButtonStyle","length","listStyle","map","itemStyle","title","removeButtonStyle","logoutButtonStyle","maxWidth","margin","padding","backgroundColor","color","borderRadius","listStyleType","marginBottom","marginLeft","border","cursor","marginTop"],"sources":["E:/Project/front/chord-site/src/pages/ProfilePage.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport songsService from '../services/songsService';\r\n\r\nconst ProfilePage = () => {\r\n  const { user, logout } = useContext(AuthContext);\r\n  const [likedSongs, setLikedSongs] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchLikedSongs = async () => {\r\n      if (user) {\r\n        try {\r\n          const favorites = await songsService.getFavorites(user.email);\r\n          setLikedSongs(favorites);\r\n        } catch (error) {\r\n          console.error(\"Ошибка при загрузке лайкнутых песен\", error);\r\n        }\r\n      }\r\n    };\r\n    fetchLikedSongs();\r\n  }, [user]);\r\n\r\n  const removeLike = async (songId) => {\r\n    try {\r\n      await songsService.removeFavorite(user.id, songId);\r\n      setLikedSongs(likedSongs.filter(song => song.id !== songId));\r\n    } catch (error) {\r\n      console.error(\"Ошибка при удалении лайка\", error);\r\n    }\r\n  };\r\n\r\n  const handleAdminPanelClick = () => {\r\n    navigate('/admin');\r\n  };\r\n\r\n  return (\r\n    <div style={profileStyle}>\r\n      <h2>Профиль пользователя</h2>\r\n      {user ? (\r\n        <>\r\n          <p>Имя: {user.username || user.email}</p>\r\n          {(user.role?.toLowerCase() === 'admin') && (\r\n            <button onClick={handleAdminPanelClick} style={adminButtonStyle}>\r\n              Открыть админ-панель\r\n            </button>\r\n          )}\r\n          <h3>Лайкнутые песни</h3>\r\n          {likedSongs.length ? (\r\n            <ul style={listStyle}>\r\n              {likedSongs.map(song => (\r\n                <li key={song.id} style={itemStyle}>\r\n                  {song.title}\r\n                  <button onClick={() => removeLike(song.id)} style={removeButtonStyle}>\r\n                    Убрать лайк\r\n                  </button>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          ) : (\r\n            <p>Нет лайкнутых песен.</p>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <p>Пользователь не авторизован.</p>\r\n      )}\r\n      <button onClick={logout} style={logoutButtonStyle}>Выйти</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst profileStyle = {\r\n  maxWidth: '600px',\r\n  margin: '50px auto',\r\n  padding: '20px',\r\n  backgroundColor: '#333',\r\n  color: '#fff',\r\n  borderRadius: '8px'\r\n};\r\n\r\nconst listStyle = {\r\n  listStyleType: 'none',\r\n  padding: 0\r\n};\r\n\r\nconst itemStyle = {\r\n  marginBottom: '10px'\r\n};\r\n\r\nconst removeButtonStyle = {\r\n  marginLeft: '10px',\r\n  backgroundColor: '#555',\r\n  color: '#fff',\r\n  border: 'none',\r\n  borderRadius: '4px',\r\n  cursor: 'pointer'\r\n};\r\n\r\nconst adminButtonStyle = {\r\n  marginBottom: '20px',\r\n  padding: '10px',\r\n  borderRadius: '4px',\r\n  backgroundColor: '#28a745',\r\n  color: '#fff',\r\n  border: 'none',\r\n  cursor: 'pointer'\r\n};\r\n\r\nconst logoutButtonStyle = {\r\n  marginTop: '20px',\r\n  padding: '10px',\r\n  borderRadius: '4px',\r\n  backgroundColor: '#d9534f',\r\n  color: '#fff',\r\n  border: 'none',\r\n  cursor: 'pointer'\r\n};\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC9D,OAASC,WAAW,KAAQ,wBAAwB,CACpD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,YAAY,KAAM,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEpD,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,KAAAC,UAAA,CACxB,KAAM,CAAEC,IAAI,CAAEC,MAAO,CAAC,CAAGf,UAAU,CAACG,WAAW,CAAC,CAChD,KAAM,CAACa,UAAU,CAAEC,aAAa,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAAAgB,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9BH,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkB,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAIL,IAAI,CAAE,CACR,GAAI,CACF,KAAM,CAAAM,SAAS,CAAG,KAAM,CAAAf,YAAY,CAACgB,YAAY,CAACP,IAAI,CAACQ,KAAK,CAAC,CAC7DL,aAAa,CAACG,SAAS,CAAC,CAC1B,CAAE,MAAOG,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,CAAEA,KAAK,CAAC,CAC7D,CACF,CACF,CAAC,CACDJ,eAAe,CAAC,CAAC,CACnB,CAAC,CAAE,CAACL,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAW,UAAU,CAAG,KAAO,CAAAC,MAAM,EAAK,CACnC,GAAI,CACF,KAAM,CAAArB,YAAY,CAACsB,cAAc,CAACb,IAAI,CAACc,EAAE,CAAEF,MAAM,CAAC,CAClDT,aAAa,CAACD,UAAU,CAACa,MAAM,CAACC,IAAI,EAAIA,IAAI,CAACF,EAAE,GAAKF,MAAM,CAAC,CAAC,CAC9D,CAAE,MAAOH,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACnD,CACF,CAAC,CAED,KAAM,CAAAQ,qBAAqB,CAAGA,CAAA,GAAM,CAClCb,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,CAED,mBACET,KAAA,QAAKuB,KAAK,CAAEC,YAAa,CAAAC,QAAA,eACvB3B,IAAA,OAAA2B,QAAA,CAAI,qHAAoB,CAAI,CAAC,CAC5BpB,IAAI,cACHL,KAAA,CAAAE,SAAA,EAAAuB,QAAA,eACEzB,KAAA,MAAAyB,QAAA,EAAG,sBAAK,CAACpB,IAAI,CAACqB,QAAQ,EAAIrB,IAAI,CAACQ,KAAK,EAAI,CAAC,CACvC,EAAAT,UAAA,CAAAC,IAAI,CAACsB,IAAI,UAAAvB,UAAA,iBAATA,UAAA,CAAWwB,WAAW,CAAC,CAAC,IAAK,OAAO,eACpC9B,IAAA,WAAQ+B,OAAO,CAAEP,qBAAsB,CAACC,KAAK,CAAEO,gBAAiB,CAAAL,QAAA,CAAC,gHAEjE,CAAQ,CACT,cACD3B,IAAA,OAAA2B,QAAA,CAAI,uFAAe,CAAI,CAAC,CACvBlB,UAAU,CAACwB,MAAM,cAChBjC,IAAA,OAAIyB,KAAK,CAAES,SAAU,CAAAP,QAAA,CAClBlB,UAAU,CAAC0B,GAAG,CAACZ,IAAI,eAClBrB,KAAA,OAAkBuB,KAAK,CAAEW,SAAU,CAAAT,QAAA,EAChCJ,IAAI,CAACc,KAAK,cACXrC,IAAA,WAAQ+B,OAAO,CAAEA,CAAA,GAAMb,UAAU,CAACK,IAAI,CAACF,EAAE,CAAE,CAACI,KAAK,CAAEa,iBAAkB,CAAAX,QAAA,CAAC,+DAEtE,CAAQ,CAAC,GAJFJ,IAAI,CAACF,EAKV,CACL,CAAC,CACA,CAAC,cAELrB,IAAA,MAAA2B,QAAA,CAAG,2GAAoB,CAAG,CAC3B,EACD,CAAC,cAEH3B,IAAA,MAAA2B,QAAA,CAAG,2JAA4B,CAAG,CACnC,cACD3B,IAAA,WAAQ+B,OAAO,CAAEvB,MAAO,CAACiB,KAAK,CAAEc,iBAAkB,CAAAZ,QAAA,CAAC,gCAAK,CAAQ,CAAC,EAC9D,CAAC,CAEV,CAAC,CAED,KAAM,CAAAD,YAAY,CAAG,CACnBc,QAAQ,CAAE,OAAO,CACjBC,MAAM,CAAE,WAAW,CACnBC,OAAO,CAAE,MAAM,CACfC,eAAe,CAAE,MAAM,CACvBC,KAAK,CAAE,MAAM,CACbC,YAAY,CAAE,KAChB,CAAC,CAED,KAAM,CAAAX,SAAS,CAAG,CAChBY,aAAa,CAAE,MAAM,CACrBJ,OAAO,CAAE,CACX,CAAC,CAED,KAAM,CAAAN,SAAS,CAAG,CAChBW,YAAY,CAAE,MAChB,CAAC,CAED,KAAM,CAAAT,iBAAiB,CAAG,CACxBU,UAAU,CAAE,MAAM,CAClBL,eAAe,CAAE,MAAM,CACvBC,KAAK,CAAE,MAAM,CACbK,MAAM,CAAE,MAAM,CACdJ,YAAY,CAAE,KAAK,CACnBK,MAAM,CAAE,SACV,CAAC,CAED,KAAM,CAAAlB,gBAAgB,CAAG,CACvBe,YAAY,CAAE,MAAM,CACpBL,OAAO,CAAE,MAAM,CACfG,YAAY,CAAE,KAAK,CACnBF,eAAe,CAAE,SAAS,CAC1BC,KAAK,CAAE,MAAM,CACbK,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SACV,CAAC,CAED,KAAM,CAAAX,iBAAiB,CAAG,CACxBY,SAAS,CAAE,MAAM,CACjBT,OAAO,CAAE,MAAM,CACfG,YAAY,CAAE,KAAK,CACnBF,eAAe,CAAE,SAAS,CAC1BC,KAAK,CAAE,MAAM,CACbK,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SACV,CAAC,CAED,cAAe,CAAA7C,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}