{"ast":null,"code":"var _jsxFileName = \"E:\\\\Project\\\\front\\\\chord-site\\\\src\\\\components\\\\SongDetails.jsx\",\n  _s = $RefreshSig$();\n// src/components/SongDetails.jsx\nimport React, { useEffect, useState, useContext } from 'react';\nimport songsService from '../services/songsService';\nimport { AuthContext } from '../context/AuthContext';\n\n// Хроматические ряды для пересчёта «корней» аккордов\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CHROMATIC_SHARP = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\nconst CHROMATIC_FLAT = ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];\nconst SongDetails = ({\n  songId\n}) => {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const [song, setSong] = useState(null);\n  const [isFavorite, setIsFavorite] = useState(false);\n\n  // Новые состояния: шаг внутри октавы (0…11) и отображаемый текст\n  const [transposeStep, setTransposeStep] = useState(0);\n  const [displayedLyrics, setDisplayedLyrics] = useState('');\n  useEffect(() => {\n    const fetchSongDetails = async () => {\n      if (!songId) {\n        setSong(null);\n        setDisplayedLyrics('');\n        setTransposeStep(0);\n        return;\n      }\n      try {\n        const data = await songsService.getSong(songId);\n        setSong(data);\n\n        // При первой загрузке отображаем оригинальную тональность (0 полутона)\n        setDisplayedLyrics(data.lyricsWithChords);\n        setTransposeStep(0);\n        if (user) {\n          const favorites = await songsService.getFavorites();\n          setIsFavorite(favorites.some(fav => fav.id === songId));\n        }\n      } catch (error) {\n        console.error(\"Ошибка при загрузке песни или избранного\", error);\n      }\n    };\n    fetchSongDetails();\n  }, [songId, user]);\n  const toggleFavorite = async () => {\n    if (!user) return;\n    try {\n      if (isFavorite) {\n        await songsService.removeFavorite(songId);\n        setIsFavorite(false);\n      } else {\n        await songsService.addFavorite(songId);\n        setIsFavorite(true);\n      }\n    } catch (error) {\n      console.error(\"Ошибка при переключении избранного\", error);\n    }\n  };\n\n  // Транспонирование одного аккорда на заданное число полутонов внутри октавы\n  const transposeChord = (chord, steps) => {\n    if (!chord || steps === 0) return chord;\n    const match = chord.match(/^([A-G])([#b]?)(.*)$/);\n    if (!match) return chord;\n    let [, root, accidental, suffix] = match;\n    let useFlats = false;\n    let noteName = root;\n    if (accidental === '#') {\n      noteName += '#';\n    } else if (accidental === 'b') {\n      noteName += 'b';\n      useFlats = true;\n    }\n    let chromatic = useFlats ? CHROMATIC_FLAT : CHROMATIC_SHARP;\n    if (!chromatic.includes(noteName)) {\n      if (CHROMATIC_SHARP.includes(noteName)) chromatic = CHROMATIC_SHARP;else if (CHROMATIC_FLAT.includes(noteName)) chromatic = CHROMATIC_FLAT;\n    }\n    let idx = chromatic.findIndex(n => n === noteName);\n    if (idx < 0) return chord;\n\n    // Сдвигаем по модулю 12 внутри хроматического круга\n    let newIndex = (idx + steps) % 12;\n    if (newIndex < 0) newIndex += 12;\n    let newRoot = chromatic[newIndex];\n    return newRoot + suffix;\n  };\n\n  // Применяет транспонирование ко всем «токенам» строки с аккордами\n  const transposeLyrics = (fullText, step) => {\n    const lines = fullText.split('\\n');\n    return lines.map(line => {\n      const tokens = line.split(/(\\s+)/);\n      const newTokens = tokens.map(tok => {\n        if (/^\\s*$/.test(tok)) return tok;\n        return transposeChord(tok, step);\n      });\n      return newTokens.join('');\n    }).join('\\n');\n  };\n\n  // ↑ Увеличиваем step по модулю 12 (после 11 идёт 0)\n  const handleTransposeUp = () => {\n    if (!song) return;\n    const newStep = (transposeStep + 1) % 12;\n    setTransposeStep(newStep);\n    setDisplayedLyrics(transposeLyrics(song.lyricsWithChords, newStep));\n  };\n\n  // ↓ Уменьшаем step по модулю 12 (с 0 переходим на 11)\n  const handleTransposeDown = () => {\n    if (!song) return;\n    const newStep = (transposeStep + 11) % 12; // эквивалентно (step - 1 + 12) % 12\n    setTransposeStep(newStep);\n    setDisplayedLyrics(transposeLyrics(song.lyricsWithChords, newStep));\n  };\n  if (!song) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: detailsPlaceholderStyle,\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u0435\\u0441\\u043D\\u044E, \\u0447\\u0442\\u043E\\u0431\\u044B \\u0443\\u0432\\u0438\\u0434\\u0435\\u0442\\u044C \\u0442\\u0435\\u043A\\u0441\\u0442 \\u0441 \\u0430\\u043A\\u043A\\u043E\\u0440\\u0434\\u0430\\u043C\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: detailsContentWrapper,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: detailsContentStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: headerStyle,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: titleStyle,\n          children: song.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), user && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: toggleFavorite,\n          style: {\n            ...likeButtonStyle,\n            backgroundColor: isFavorite ? '#d9534f' : '#28a745'\n          },\n          children: isFavorite ? 'Убрать из избранного' : 'В избранное'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        style: authorStyle,\n        children: [\"\\u0418\\u0441\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C: \", song.author]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: transposeControlsWrapper,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleTransposeDown,\n          style: transposeButtonStyle,\n          children: \"\\u2193\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: transposeInfoStyle,\n          children: [\"\\u0422\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C: \", transposeStep, \" \", transposeStep === 1 ? 'полутон' : transposeStep === 0 ? 'оригинал' : 'полутона(ов)']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleTransposeUp,\n          style: transposeButtonStyle,\n          children: \"\\u2191\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        style: lyricsStyle,\n        children: displayedLyrics\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 141,\n    columnNumber: 5\n  }, this);\n};\n\n/** Стили */\n_s(SongDetails, \"IkPIy/R3FlOifCbwzpfFfTSt0qo=\");\n_c = SongDetails;\nconst detailsContentWrapper = {\n  display: 'flex',\n  justifyContent: 'center',\n  width: '100%'\n};\nconst detailsContentStyle = {\n  width: '100%',\n  maxWidth: '800px',\n  backgroundColor: '#3d4044',\n  padding: '1.5rem',\n  borderRadius: '8px',\n  boxShadow: '0 0 10px rgba(0,0,0,0.5)',\n  fontSize: '1.2rem',\n  lineHeight: '1.6'\n};\nconst detailsPlaceholderStyle = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  width: '100%',\n  color: '#ccc'\n};\nconst headerStyle = {\n  display: 'flex',\n  justifyContent: 'space-between',\n  alignItems: 'center'\n};\nconst titleStyle = {\n  marginTop: 0,\n  fontSize: '2rem',\n  fontWeight: 'bold'\n};\nconst authorStyle = {\n  color: '#ccc',\n  marginBottom: '1rem',\n  fontSize: '1.3rem'\n};\nconst transposeControlsWrapper = {\n  display: 'flex',\n  alignItems: 'center',\n  marginBottom: '1rem'\n};\nconst transposeButtonStyle = {\n  padding: '0.3rem 0.6rem',\n  fontSize: '1.2rem',\n  margin: '0 0.5rem',\n  borderRadius: '4px',\n  border: 'none',\n  cursor: 'pointer',\n  backgroundColor: '#555',\n  color: '#fff'\n};\nconst transposeInfoStyle = {\n  color: '#fff',\n  fontSize: '1rem'\n};\nconst lyricsStyle = {\n  whiteSpace: 'pre-wrap',\n  fontFamily: 'monospace',\n  fontSize: '1.2rem',\n  marginTop: '1rem',\n  color: '#fff'\n};\nconst likeButtonStyle = {\n  padding: '0.5rem 1rem',\n  fontSize: '1rem',\n  border: 'none',\n  borderRadius: '6px',\n  color: '#fff',\n  cursor: 'pointer'\n};\nexport default SongDetails;\nvar _c;\n$RefreshReg$(_c, \"SongDetails\");","map":{"version":3,"names":["React","useEffect","useState","useContext","songsService","AuthContext","jsxDEV","_jsxDEV","CHROMATIC_SHARP","CHROMATIC_FLAT","SongDetails","songId","_s","user","song","setSong","isFavorite","setIsFavorite","transposeStep","setTransposeStep","displayedLyrics","setDisplayedLyrics","fetchSongDetails","data","getSong","lyricsWithChords","favorites","getFavorites","some","fav","id","error","console","toggleFavorite","removeFavorite","addFavorite","transposeChord","chord","steps","match","root","accidental","suffix","useFlats","noteName","chromatic","includes","idx","findIndex","n","newIndex","newRoot","transposeLyrics","fullText","step","lines","split","map","line","tokens","newTokens","tok","test","join","handleTransposeUp","newStep","handleTransposeDown","style","detailsPlaceholderStyle","children","fileName","_jsxFileName","lineNumber","columnNumber","detailsContentWrapper","detailsContentStyle","headerStyle","titleStyle","title","onClick","likeButtonStyle","backgroundColor","authorStyle","author","transposeControlsWrapper","transposeButtonStyle","transposeInfoStyle","lyricsStyle","_c","display","justifyContent","width","maxWidth","padding","borderRadius","boxShadow","fontSize","lineHeight","alignItems","color","marginTop","fontWeight","marginBottom","margin","border","cursor","whiteSpace","fontFamily","$RefreshReg$"],"sources":["E:/Project/front/chord-site/src/components/SongDetails.jsx"],"sourcesContent":["// src/components/SongDetails.jsx\r\nimport React, { useEffect, useState, useContext } from 'react';\r\nimport songsService from '../services/songsService';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\n// Хроматические ряды для пересчёта «корней» аккордов\r\nconst CHROMATIC_SHARP = [\r\n  'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'\r\n];\r\nconst CHROMATIC_FLAT  = [\r\n  'C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'\r\n];\r\n\r\nconst SongDetails = ({ songId }) => {\r\n  const { user } = useContext(AuthContext);\r\n  const [song, setSong] = useState(null);\r\n  const [isFavorite, setIsFavorite] = useState(false);\r\n\r\n  // Новые состояния: шаг внутри октавы (0…11) и отображаемый текст\r\n  const [transposeStep, setTransposeStep] = useState(0);\r\n  const [displayedLyrics, setDisplayedLyrics] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchSongDetails = async () => {\r\n      if (!songId) {\r\n        setSong(null);\r\n        setDisplayedLyrics('');\r\n        setTransposeStep(0);\r\n        return;\r\n      }\r\n      try {\r\n        const data = await songsService.getSong(songId);\r\n        setSong(data);\r\n\r\n        // При первой загрузке отображаем оригинальную тональность (0 полутона)\r\n        setDisplayedLyrics(data.lyricsWithChords);\r\n        setTransposeStep(0);\r\n\r\n        if (user) {\r\n          const favorites = await songsService.getFavorites();\r\n          setIsFavorite(favorites.some(fav => fav.id === songId));\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Ошибка при загрузке песни или избранного\", error);\r\n      }\r\n    };\r\n\r\n    fetchSongDetails();\r\n  }, [songId, user]);\r\n\r\n  const toggleFavorite = async () => {\r\n    if (!user) return;\r\n    try {\r\n      if (isFavorite) {\r\n        await songsService.removeFavorite(songId);\r\n        setIsFavorite(false);\r\n      } else {\r\n        await songsService.addFavorite(songId);\r\n        setIsFavorite(true);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Ошибка при переключении избранного\", error);\r\n    }\r\n  };\r\n\r\n  // Транспонирование одного аккорда на заданное число полутонов внутри октавы\r\n  const transposeChord = (chord, steps) => {\r\n    if (!chord || steps === 0) return chord;\r\n\r\n    const match = chord.match(/^([A-G])([#b]?)(.*)$/);\r\n    if (!match) return chord;\r\n\r\n    let [ , root, accidental, suffix ] = match;\r\n    let useFlats = false;\r\n\r\n    let noteName = root;\r\n    if (accidental === '#') {\r\n      noteName += '#';\r\n    } else if (accidental === 'b') {\r\n      noteName += 'b';\r\n      useFlats = true;\r\n    }\r\n\r\n    let chromatic = useFlats ? CHROMATIC_FLAT : CHROMATIC_SHARP;\r\n    if (!chromatic.includes(noteName)) {\r\n      if (CHROMATIC_SHARP.includes(noteName)) chromatic = CHROMATIC_SHARP;\r\n      else if (CHROMATIC_FLAT.includes(noteName)) chromatic = CHROMATIC_FLAT;\r\n    }\r\n\r\n    let idx = chromatic.findIndex(n => n === noteName);\r\n    if (idx < 0) return chord;\r\n\r\n    // Сдвигаем по модулю 12 внутри хроматического круга\r\n    let newIndex = (idx + steps) % 12;\r\n    if (newIndex < 0) newIndex += 12;\r\n\r\n    let newRoot = chromatic[newIndex];\r\n    return newRoot + suffix;\r\n  };\r\n\r\n  // Применяет транспонирование ко всем «токенам» строки с аккордами\r\n  const transposeLyrics = (fullText, step) => {\r\n    const lines = fullText.split('\\n');\r\n    return lines\r\n      .map(line => {\r\n        const tokens = line.split(/(\\s+)/);\r\n        const newTokens = tokens.map(tok => {\r\n          if (/^\\s*$/.test(tok)) return tok;\r\n          return transposeChord(tok, step);\r\n        });\r\n        return newTokens.join('');\r\n      })\r\n      .join('\\n');\r\n  };\r\n\r\n  // ↑ Увеличиваем step по модулю 12 (после 11 идёт 0)\r\n  const handleTransposeUp = () => {\r\n    if (!song) return;\r\n    const newStep = (transposeStep + 1) % 12;\r\n    setTransposeStep(newStep);\r\n    setDisplayedLyrics(transposeLyrics(song.lyricsWithChords, newStep));\r\n  };\r\n\r\n  // ↓ Уменьшаем step по модулю 12 (с 0 переходим на 11)\r\n  const handleTransposeDown = () => {\r\n    if (!song) return;\r\n    const newStep = (transposeStep + 11) % 12; // эквивалентно (step - 1 + 12) % 12\r\n    setTransposeStep(newStep);\r\n    setDisplayedLyrics(transposeLyrics(song.lyricsWithChords, newStep));\r\n  };\r\n\r\n  if (!song) {\r\n    return (\r\n      <div style={detailsPlaceholderStyle}>\r\n        <p>Выберите песню, чтобы увидеть текст с аккордами</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={detailsContentWrapper}>\r\n      <div style={detailsContentStyle}>\r\n        <div style={headerStyle}>\r\n          <h2 style={titleStyle}>{song.title}</h2>\r\n          {user && (\r\n            <button\r\n              onClick={toggleFavorite}\r\n              style={{\r\n                ...likeButtonStyle,\r\n                backgroundColor: isFavorite ? '#d9534f' : '#28a745',\r\n              }}\r\n            >\r\n              {isFavorite ? 'Убрать из избранного' : 'В избранное'}\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        <h4 style={authorStyle}>Исполнитель: {song.author}</h4>\r\n\r\n        {/* Блок транспонирования */}\r\n        <div style={transposeControlsWrapper}>\r\n          <button onClick={handleTransposeDown} style={transposeButtonStyle}>↓</button>\r\n          <span style={transposeInfoStyle}>\r\n            Тональность: {transposeStep} {transposeStep === 1 ? 'полутон' : transposeStep === 0 ? 'оригинал' : 'полутона(ов)'}\r\n          </span>\r\n          <button onClick={handleTransposeUp} style={transposeButtonStyle}>↑</button>\r\n        </div>\r\n\r\n        {/* Отображаем текст (исходный или транспонированный) */}\r\n        <pre style={lyricsStyle}>{displayedLyrics}</pre>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n/** Стили */\r\nconst detailsContentWrapper = {\r\n  display: 'flex',\r\n  justifyContent: 'center',\r\n  width: '100%',\r\n};\r\n\r\nconst detailsContentStyle = {\r\n  width: '100%',\r\n  maxWidth: '800px',\r\n  backgroundColor: '#3d4044',\r\n  padding: '1.5rem',\r\n  borderRadius: '8px',\r\n  boxShadow: '0 0 10px rgba(0,0,0,0.5)',\r\n  fontSize: '1.2rem',\r\n  lineHeight: '1.6',\r\n};\r\n\r\nconst detailsPlaceholderStyle = {\r\n  display: 'flex',\r\n  justifyContent: 'center',\r\n  alignItems: 'center',\r\n  width: '100%',\r\n  color: '#ccc',\r\n};\r\n\r\nconst headerStyle = {\r\n  display: 'flex',\r\n  justifyContent: 'space-between',\r\n  alignItems: 'center',\r\n};\r\n\r\nconst titleStyle = {\r\n  marginTop: 0,\r\n  fontSize: '2rem',\r\n  fontWeight: 'bold',\r\n};\r\n\r\nconst authorStyle = {\r\n  color: '#ccc',\r\n  marginBottom: '1rem',\r\n  fontSize: '1.3rem',\r\n};\r\n\r\nconst transposeControlsWrapper = {\r\n  display: 'flex',\r\n  alignItems: 'center',\r\n  marginBottom: '1rem',\r\n};\r\n\r\nconst transposeButtonStyle = {\r\n  padding: '0.3rem 0.6rem',\r\n  fontSize: '1.2rem',\r\n  margin: '0 0.5rem',\r\n  borderRadius: '4px',\r\n  border: 'none',\r\n  cursor: 'pointer',\r\n  backgroundColor: '#555',\r\n  color: '#fff',\r\n};\r\n\r\nconst transposeInfoStyle = {\r\n  color: '#fff',\r\n  fontSize: '1rem',\r\n};\r\n\r\nconst lyricsStyle = {\r\n  whiteSpace: 'pre-wrap',\r\n  fontFamily: 'monospace',\r\n  fontSize: '1.2rem',\r\n  marginTop: '1rem',\r\n  color: '#fff',\r\n};\r\n\r\nconst likeButtonStyle = {\r\n  padding: '0.5rem 1rem',\r\n  fontSize: '1rem',\r\n  border: 'none',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  cursor: 'pointer',\r\n};\r\n\r\nexport default SongDetails;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}